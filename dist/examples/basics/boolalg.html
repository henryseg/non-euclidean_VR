<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../../../images/favicon.png">
    <!-- Style sheets -->
    <link rel="stylesheet" href="../css/style.css">

    <title>Boolean algebra</title>
    <!-- Import maps polyfill -->
    <!-- Remove this when import maps will be widely supported -->
    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
    <script type="importmap">
        {
            "imports": {
                "three": "../jsm/three.module.js",
                "thurstonEuc": "../../build/thurstonEuc.js"
            }
        }
    </script>
</head>
<body>
<a id="source" href="https://github.com/henryseg/non-euclidean_VR/blob/cleanCode/examples/basics/boolalg.js"></a>
</body>
<script type="module" id="main">

    import {
        freeAbelianSet as torus,
        BasicCamera, BasicRenderer, Scene,
        Point, BallShape, LocalBallShape, UnionShape, IntersectionShape, ComplementShape, WrapShape, Solid,
        FlyControls, PhongMaterial, PointLight, SMOOTH_MIN_POLY, SMOOTH_MAX_POLY
    } from "thurstonEuc";
    import {Clock, Color} from "three"


    // initial setup
    const camera = new BasicCamera({set: torus});
    const scene = new Scene();

    const renderer = new BasicRenderer(torus, camera, scene, {}, {
        logarithmicDepthBuffer: true
    });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);


    // magenta light
    const light = new PointLight(
        new Point(0, 0.2, 0),
        new Color(1, 1, 1),
        0.5
    );
    const lights = [light];

    // Phong shading material
    const mat0 = new PhongMaterial({
        color: new Color(0, 0, 1),
        specular: 0.1,
        shininess: 1,
        lights: lights
    });
    const mat1 = new PhongMaterial({
        color: new Color(0, 1, 0),
        specular: 0.1,
        shininess: 1,
        lights: lights
    });
    const mat2 = new PhongMaterial({
        color: new Color(1, 0, 0),
        specular: 0.1,
        shininess: 1,
        lights: lights
    });
    const mat3 = new PhongMaterial({
        color: new Color(1, 1, 0),
        specular: 0.1,
        shininess: 1,
        lights: lights
    });

    // Complement of a local ball
    const ball0 = new LocalBallShape(
        new Point(0, 0, 0),
        1.3,
    );

    const complementShape = new ComplementShape(ball0);
    const complementSolid = new Solid(complementShape, mat0);


    // Union of two balls
    const ball1 = new BallShape(
        new Point(-0.5, -0.08, 0),
        0.15
    );

    const ball2 = new BallShape(
        new Point(-0.5, 0.08, 0),
        0.15
    );

    const unionShape = new UnionShape(ball1, ball2, {minType: SMOOTH_MIN_POLY, minCoeff: 0.01});
    const unionSolid = new Solid(unionShape, mat1);


    // Intersection of two balls
    const ball3 = new BallShape(
        new Point(0.5, -0.08, 0),
        0.15
    );

    const ball4 = new BallShape(
        new Point(0.5, 0.08, 0),
        0.15
    );

    const intersectionShape = new IntersectionShape(ball3, ball4, {maxType: SMOOTH_MAX_POLY, maxCoeff: 0.01});
    const intersectionSolid = new Solid(intersectionShape, mat2);


    // Wrap of a ball by another ball
    const ball5 = new BallShape(
        new Point(0, 0, -1),
        0.1
    )

    const ball6 = new BallShape(
        new Point(0, 0, -1),
        0.5
    );

    const wrapShape = new WrapShape(ball6, ball5);
    const wrapSolid = new Solid(wrapShape, mat3);

    // adding the solid to the scene
    scene.add(unionSolid, intersectionSolid, complementSolid, wrapSolid);

    // building there renderer
    renderer.build();

    // event controller on windows resize
    function onWindowResize(event) {
        renderer.setSize(window.innerWidth, window.innerHeight);
        camera.aspect = window.innerWidth / window.innerHeight
        camera.updateProjectionMatrix();
    }

    window.addEventListener("resize", onWindowResize, false);


    const clock = new Clock();
    const flyControls = new FlyControls(camera, 'fr');


    // rendering the scene
    function animate() {
        const delta = clock.getDelta();
        flyControls.update(delta);
        renderer.render();
    }

    renderer.setAnimationLoop(animate);
    renderer.checkShader();


</script>
</html>