<?xml version="1.0" encoding="UTF-8"?>
<library>
    <background>
        /**
         * Distance between two points
         */
        float dist(Point p1, Point p2){
            return length(p1.coords - p2.coords);
        }
    </background>
    <items>
        <solid class="ball">
            <shader type="declare">
                Solid {{name}};
            </shader>
            <shader type="setup">
                {{name}} = {{toGLSL}};
            </shader>
            <shader type="sdf">
                Point loc = {{name}}.item.loc;
                {{#global}}
                loc = applyIsometry(v.invCellBoost, loc);
                {{/global}}
                return dist(v.local.pos, loc) - {{radius}};
            </shader>
            <shader type="gradient">
                Point loc = {{name}}.item.loc;
                {{#global}}
                loc = applyIsometry(v.invCellBoost, loc);
                {{/global}}
                Vector local = Vector(v.local.pos, v.local.pos.coords - loc.coords);
                local =  geomNormalize(local);
                return RelVector(local, v.cellBoost, v.invCellBoost);
            </shader>
        </solid>

        <light class="pointLight">
            <shader type="declare">
                Light {{name}};
            </shader>
            <shader type="setup">
                {{name}} = {{toGLSL}};
            </shader>
        </light>
    </items>
</library>